from pandas.core.frame import DataFrame
from connect import get, copy_from_file
import pandas as pd
from matplotlib import pyplot as plt
from datetime import timedelta, date
import random as rd


cols = '*'
tbl = 'neg_training_all'
tb2 = 'testing_40_pos'
modifier = None
where = None
df_neg = get(tbl, cols, where, modifier)
df_pos = get(tb2, cols, where, modifier)


result = []


for pos in range(len(df_pos)) :
    result.append(df_pos.loc[pos])

for i in range(1294) :     
    random = rd.randint(0, len(df_neg)-1)
    result.append(df_neg.loc[random])
    df_neg.drop(index=random, axis=0, inplace=False)


print(len(result)) #1333
df = pd.DataFrame(result) 
df.drop_duplicates()
print(df.size)
copy_from_file(df, 'testing_set')
